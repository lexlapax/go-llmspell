<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #f0f4f8; stroke: #2d3748; stroke-width: 2; }
      .component { fill: #bee3f8; stroke: #2b6cb0; stroke-width: 2; }
      .interface { fill: #e9d8fd; stroke: #6b46c1; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; }
      .small { font-size: 12px; }
      .title { font-size: 18px; font-weight: bold; }
      .arrow { fill: none; stroke: #4a5568; stroke-width: 2; marker-end: url(#arrowhead); }
      .dashed { stroke-dasharray: 5, 5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4a5568" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" class="text title">Script Engine Architecture</text>
  
  <!-- ScriptEngine Interface -->
  <rect x="200" y="60" width="400" height="180" class="interface" rx="5"/>
  <text x="400" y="85" class="text title">ScriptEngine Interface</text>
  <text x="400" y="110" class="text small">Execute(ctx, script, params) → result</text>
  <text x="400" y="130" class="text small">ExecuteFile(ctx, path, params) → result</text>
  <text x="400" y="150" class="text small">RegisterBridge(name, bridge) → error</text>
  <text x="400" y="170" class="text small">SetMemoryLimit(bytes) → error</text>
  <text x="400" y="190" class="text small">SetTimeout(duration) → error</text>
  <text x="400" y="210" class="text small">ToNative(scriptValue) → goValue</text>
  <text x="400" y="230" class="text small">FromNative(goValue) → scriptValue</text>
  
  <!-- Engine Implementations -->
  <rect x="50" y="280" width="200" height="120" class="component" rx="5"/>
  <text x="150" y="305" class="text">Lua Engine</text>
  <text x="150" y="330" class="text small">• GopherLua integration</text>
  <text x="150" y="350" class="text small">• Lua 5.1 compatible</text>
  <text x="150" y="370" class="text small">• Coroutine support</text>
  <text x="150" y="390" class="text small">• Module system</text>
  
  <rect x="300" y="280" width="200" height="120" class="component" rx="5"/>
  <text x="400" y="305" class="text">JavaScript Engine</text>
  <text x="400" y="330" class="text small">• Goja integration</text>
  <text x="400" y="350" class="text small">• ES6+ support</text>
  <text x="400" y="370" class="text small">• Promise/async</text>
  <text x="400" y="390" class="text small">• CommonJS modules</text>
  
  <rect x="550" y="280" width="200" height="120" class="component" rx="5"/>
  <text x="650" y="305" class="text">Tengo Engine</text>
  <text x="650" y="330" class="text small">• Native Tengo VM</text>
  <text x="650" y="350" class="text small">• Fast execution</text>
  <text x="650" y="370" class="text small">• Compiled scripts</text>
  <text x="650" y="390" class="text small">• Import system</text>
  
  <!-- Engine Components -->
  <rect x="50" y="440" width="150" height="100" class="box" rx="5"/>
  <text x="125" y="465" class="text">Security Sandbox</text>
  <text x="125" y="485" class="text small">• Function limits</text>
  <text x="125" y="505" class="text small">• FS restrictions</text>
  <text x="125" y="525" class="text small">• Network control</text>
  
  <rect x="230" y="440" width="150" height="100" class="box" rx="5"/>
  <text x="305" y="465" class="text">Type Converter</text>
  <text x="305" y="485" class="text small">• Script ↔ Go</text>
  <text x="305" y="505" class="text small">• Type validation</text>
  <text x="305" y="525" class="text small">• Custom adapters</text>
  
  <rect x="410" y="440" width="150" height="100" class="box" rx="5"/>
  <text x="485" y="465" class="text">Resource Manager</text>
  <text x="485" y="485" class="text small">• Memory limits</text>
  <text x="485" y="505" class="text small">• CPU timeouts</text>
  <text x="485" y="525" class="text small">• Goroutine limits</text>
  
  <rect x="590" y="440" width="160" height="100" class="box" rx="5"/>
  <text x="670" y="465" class="text">Bridge Registry</text>
  <text x="670" y="485" class="text small">• Bridge lifecycle</text>
  <text x="670" y="505" class="text small">• Method exposure</text>
  <text x="670" y="525" class="text small">• Permission check</text>
  
  <!-- Arrows -->
  <path d="M 150 240 L 150 280" class="arrow dashed"/>
  <path d="M 400 240 L 400 280" class="arrow dashed"/>
  <path d="M 650 240 L 650 280" class="arrow dashed"/>
  
  <path d="M 150 400 L 125 440" class="arrow"/>
  <path d="M 150 400 L 305 440" class="arrow"/>
  <path d="M 400 400 L 305 440" class="arrow"/>
  <path d="M 400 400 L 485 440" class="arrow"/>
  <path d="M 650 400 L 485 440" class="arrow"/>
  <path d="M 650 400 L 670 440" class="arrow"/>
  
  <!-- Labels -->
  <text x="100" y="265" class="small">implements</text>
  <text x="400" y="265" class="small">implements</text>
  <text x="700" y="265" class="small">implements</text>
</svg>